@model Shop.Model.Config
@{
    ViewBag.Title = "Commodity_Create";
    var fileAttrList = ViewBag.FileAttrList as List<Shop.Model.FileAttr>;
}

<script type="text/javascript">
    //上传图片保存至服务端
    function SiteConfig_Commodity_Create_UploadComplete(event, response, status) {
        if (status) {
            var json = eval("(" + response + ")");
            if (json.status == 1) {
                $.post("/Common/Upload/AddPic", { "newFileName": json.data.newFileName, "originalFileName": json.data.originalFileName }, function (data) {
                    if (data.statusCode == "Ok") {
                        alertMsg.correct(json.msg);
                        $('#fileAttrTable tbody tr:last').before('<tr><td>' + json.data.originalFileName + '<input type="hidden" value=' + data.id + ' name="imageIds"/></td><td><img src=' + json.data.newFileName + ' style="width:90px;height:90px" /></td><td><a style="font-size: 12px; margin-left: 3px" title="删除" href="javascript:;" onclick="SiteConfig_Commodity_Create_DeleteFile(this,' + data.id + ');">删除</a><a style="font-size: 12px; margin-left: 3px" title="设置默认图片" href="javascript:;" onclick="SiteConfig_Commodity_Create_SetDefaultImg(this);">默认图片</a></td></tr>');
                    }
                    else {
                        console.log(data.msg);
                        alertMsg.error(data.msg);
                    }
                });
            }
            else {
                console.log(json.msg);
                alertMsg.error(json.msg);
            }
        }
    }

    //删除图片
    function SiteConfig_Commodity_Create_DeleteFile(btn, id) {
        $.post("/Common/Upload/DeleteFile", { "id": id }, function (data) {
            if (data.statusCode == "200") {
                alertMsg.correct(data.message);
                $(btn).closest('tr').remove();
            }
            else {
                console.log(data.message);
                alertMsg.error(data.message);
            }
        });
    }
    //设置默认图片
    function SiteConfig_Commodity_Create_SetDefaultImg(btn) {
        var src = $(btn).closest('tr').find('img').attr('src');
        $('#imgCommodity').attr('src', src);
        $('#Commodity_ImagePath').val(src);
    }
</script>
<h2 class="contentTitle">商品管理</h2>
<div class="pageContent">
    @using (Html.BeginForm("Create", "Config", FormMethod.Post, new Dictionary<string, object>() { { "class", "" }, { "onsubmit", "return validateCallback(this,navTabAjaxDone);" } }))
    {
        <div class="pageFormContent" layouth="140">           
            <dl>
                <dt>网站名称</dt>
                <dd>
                    @Html.TextBoxFor(m => m.ConfigName)
                </dd>
            </dl>
            <dl>
                <dt>网站样式</dt>
                <dd>
                    <label>@Html.RadioButton("PhoneStyle", "skin1", Model.PhoneStyle == "skin1") 颜色1</label>
                    <label>@Html.RadioButton("PhoneStyle", "skin2", Model.PhoneStyle == "skin2") 颜色2</label>
                    <label>@Html.RadioButton("PhoneStyle", "skin3", Model.PhoneStyle == "skin3") 颜色3</label>
                </dd>
            </dl>
            <dl>
                <dt>页脚信息</dt>
                <dd>
                    @Html.TextBoxFor(m => m.Footer)
                </dd>
            </dl>
        </div>
        <div class="formBar">
            <ul>
                <li><div class="buttonActive"><div class="buttonContent"><button type="submit">保存</button></div></div></li>
                <li><div class="button"><div class="buttonContent"><button type="button" class="close">关闭</button></div></div></li>
            </ul>
        </div>
    }
</div>